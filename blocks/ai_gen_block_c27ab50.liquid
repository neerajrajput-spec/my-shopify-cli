{% doc %}
  @prompt
    Create a dark mode and light mode toggle switch that allows users to switch between dark and light color schemes. The toggle should:- Be a clean, accessible button or switch control- Save the user's preference in local storage so it persists across page visits- Smoothly transition between light and dark modes- Apply appropriate color schemes: light backgrounds with dark text for light mode, and dark backgrounds with light text for dark mode- Be mobile-responsive and work well on all screen sizes- Include a sun/moon icon or similar visual indicator- Position the toggle in a convenient location (like top right of the page)- Use CSS variables for easy color customization
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  :root {
    --ai-dm-light-bg-{{ ai_gen_id }}: {{ block.settings.light_bg_color }};
    --ai-dm-light-text-{{ ai_gen_id }}: {{ block.settings.light_text_color }};
    --ai-dm-dark-bg-{{ ai_gen_id }}: {{ block.settings.dark_bg_color }};
    --ai-dm-dark-text-{{ ai_gen_id }}: {{ block.settings.dark_text_color }};
  }

  .ai-dark-mode-toggle-{{ ai_gen_id }} {
    position: {{ block.settings.position }};
    {% if block.settings.position == 'fixed' %}
      top: {{ block.settings.top_offset }}px;
      right: {{ block.settings.right_offset }}px;
      z-index: 1000;
    {% endif %}
  }

  .ai-dark-mode-toggle__button-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: center;
    width: {{ block.settings.toggle_size }}px;
    height: {{ block.settings.toggle_size }}px;
    border-radius: {{ block.settings.border_radius }}px;
    background-color: {{ block.settings.toggle_bg_color }};
    border: {{ block.settings.border_thickness }}px solid {{ block.settings.border_color }};
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .ai-dark-mode-toggle__button-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.toggle_hover_bg_color }};
    transform: scale(1.05);
  }

  .ai-dark-mode-toggle__icon-{{ ai_gen_id }} {
    width: calc({{ block.settings.toggle_size }}px * 0.5);
    height: calc({{ block.settings.toggle_size }}px * 0.5);
    color: {{ block.settings.icon_color }};
    transition: all 0.3s ease;
  }

  .ai-dark-mode-toggle__icon-{{ ai_gen_id }}.hidden {
    opacity: 0;
    transform: rotate(180deg) scale(0);
    position: absolute;
  }

  .ai-dark-mode-toggle__icon-{{ ai_gen_id }}.visible {
    opacity: 1;
    transform: rotate(0deg) scale(1);
  }

  body.ai-dark-mode-{{ ai_gen_id }} {
    background-color: var(--ai-dm-dark-bg-{{ ai_gen_id }});
    color: var(--ai-dm-dark-text-{{ ai_gen_id }});
    transition: background-color {{ block.settings.transition_speed }}s ease, color {{ block.settings.transition_speed }}s ease;
  }

  body:not(.ai-dark-mode-{{ ai_gen_id }}) {
    background-color: var(--ai-dm-light-bg-{{ ai_gen_id }});
    color: var(--ai-dm-light-text-{{ ai_gen_id }});
    transition: background-color {{ block.settings.transition_speed }}s ease, color {{ block.settings.transition_speed }}s ease;
  }

  @media screen and (max-width: 749px) {
    .ai-dark-mode-toggle-{{ ai_gen_id }} {
      {% if block.settings.position == 'fixed' %}
        top: {{ block.settings.mobile_top_offset }}px;
        right: {{ block.settings.mobile_right_offset }}px;
      {% endif %}
    }

    .ai-dark-mode-toggle__button-{{ ai_gen_id }} {
      width: {{ block.settings.mobile_toggle_size }}px;
      height: {{ block.settings.mobile_toggle_size }}px;
    }

    .ai-dark-mode-toggle__icon-{{ ai_gen_id }} {
      width: calc({{ block.settings.mobile_toggle_size }}px * 0.5);
      height: calc({{ block.settings.mobile_toggle_size }}px * 0.5);
    }
  }
{% endstyle %}

<dark-mode-toggle-{{ ai_gen_id }} class="ai-dark-mode-toggle-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <button
    class="ai-dark-mode-toggle__button-{{ ai_gen_id }}"
    aria-label="Toggle dark mode"
    aria-pressed="false"
  >
    <svg
      class="ai-dark-mode-toggle__icon-{{ ai_gen_id }} ai-dark-mode-toggle__sun-{{ ai_gen_id }} visible"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
    <svg
      class="ai-dark-mode-toggle__icon-{{ ai_gen_id }} ai-dark-mode-toggle__moon-{{ ai_gen_id }} hidden"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
    </svg>
  </button>
</dark-mode-toggle-{{ ai_gen_id }}>

<script>
  (function() {
    class DarkModeToggle{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.button = this.querySelector('.ai-dark-mode-toggle__button-{{ ai_gen_id }}');
        this.sunIcon = this.querySelector('.ai-dark-mode-toggle__sun-{{ ai_gen_id }}');
        this.moonIcon = this.querySelector('.ai-dark-mode-toggle__moon-{{ ai_gen_id }}');
        this.storageKey = 'ai-dark-mode-{{ ai_gen_id }}';
      }

      connectedCallback() {
        this.loadPreference();
        this.button.addEventListener('click', () => this.toggleDarkMode());
      }

      loadPreference() {
        const savedMode = localStorage.getItem(this.storageKey);
        if (savedMode === 'dark') {
          this.enableDarkMode();
        } else {
          this.disableDarkMode();
        }
      }

      toggleDarkMode() {
        if (document.body.classList.contains('ai-dark-mode-{{ ai_gen_id }}')) {
          this.disableDarkMode();
          localStorage.setItem(this.storageKey, 'light');
        } else {
          this.enableDarkMode();
          localStorage.setItem(this.storageKey, 'dark');
        }
      }

      enableDarkMode() {
        document.body.classList.add('ai-dark-mode-{{ ai_gen_id }}');
        this.sunIcon.classList.remove('visible');
        this.sunIcon.classList.add('hidden');
        this.moonIcon.classList.remove('hidden');
        this.moonIcon.classList.add('visible');
        this.button.setAttribute('aria-pressed', 'true');
      }

      disableDarkMode() {
        document.body.classList.remove('ai-dark-mode-{{ ai_gen_id }}');
        this.moonIcon.classList.remove('visible');
        this.moonIcon.classList.add('hidden');
        this.sunIcon.classList.remove('hidden');
        this.sunIcon.classList.add('visible');
        this.button.setAttribute('aria-pressed', 'false');
      }
    }

    customElements.define('dark-mode-toggle-{{ ai_gen_id }}', DarkModeToggle{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Dark mode toggle",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Position"
    },
    {
      "type": "select",
      "id": "position",
      "label": "Position type",
      "options": [
        {
          "value": "fixed",
          "label": "Fixed (stays in place)"
        },
        {
          "value": "relative",
          "label": "Relative (flows with content)"
        }
      ],
      "default": "fixed"
    },
    {
      "type": "range",
      "id": "top_offset",
      "min": 0,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "Top offset",
      "default": 20
    },
    {
      "type": "range",
      "id": "right_offset",
      "min": 0,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "Right offset",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_top_offset",
      "min": 0,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "Mobile top offset",
      "default": 10
    },
    {
      "type": "range",
      "id": "mobile_right_offset",
      "min": 0,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "Mobile right offset",
      "default": 10
    },
    {
      "type": "header",
      "content": "Toggle button"
    },
    {
      "type": "range",
      "id": "toggle_size",
      "min": 40,
      "max": 80,
      "step": 5,
      "unit": "px",
      "label": "Size",
      "default": 50
    },
    {
      "type": "range",
      "id": "mobile_toggle_size",
      "min": 30,
      "max": 60,
      "step": 5,
      "unit": "px",
      "label": "Mobile size",
      "default": 45
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 24
    },
    {
      "type": "range",
      "id": "border_thickness",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Border thickness",
      "default": 1
    },
    {
      "type": "color",
      "id": "toggle_bg_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "toggle_hover_bg_color",
      "label": "Hover background color",
      "default": "#f3f3f3"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "icon_color",
      "label": "Icon color",
      "default": "#121212"
    },
    {
      "type": "header",
      "content": "Light mode colors"
    },
    {
      "type": "color",
      "id": "light_bg_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "light_text_color",
      "label": "Text",
      "default": "#121212"
    },
    {
      "type": "header",
      "content": "Dark mode colors"
    },
    {
      "type": "color",
      "id": "dark_bg_color",
      "label": "Background",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "dark_text_color",
      "label": "Text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Animation"
    },
    {
      "type": "range",
      "id": "transition_speed",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "unit": "s",
      "label": "Transition speed",
      "default": 0.3
    }
  ],
  "presets": [
    {
      "name": "Dark mode toggle"
    }
  ]
}
{% endschema %}